{
    "description": "Control flow deobfuscation: unflattens control flow, removes dispatcher blocks, and unrolls bogus while loops (e.g., Approov-style obfuscation). This config combines Unflattener rules with BadWhileLoop detection and JumpFixer to restore natural control flow.",
    "ins_rules": [],
    "blk_rules": [
        {
            "name": "MbaStatePreconditioner",
            "is_activated": true,
            "config": {
                "max_optimize_local_rounds": 1
            }
        },
        {
            "name": "UnflattenerSwitchCase",
            "is_activated": true,
            "config": {}
        },
        {
            "name": "UnflattenerTigressIndirect",
            "is_activated": true,
            "config": {}
        },
        {
            "name": "BadWhileLoop",
            "is_activated": true,
            "config": {}
        },
        {
            "name": "Unflattener",
            "is_activated": true,
            "config": {
                "max_passes": 5,
                "min_dispatcher_internal_block": 2,
                "min_dispatcher_exit_block": 2,
                "min_dispatcher_comparison_value": 2,
                "max_calls_entry_preds": 24,
                "max_calls_exit_blocks": 24,
                "defer_calls_on_conditional_entry_father": true,
                "log_calls_layout_signals": true,
                "min_entropy": 0.0,
                "max_entropy": 1.0
            }
        },
        {
            "name": "JumpFixer",
            "is_activated": true,
            "config": {
                "enabled_rules": [
                    "CompareConstantRule1",
                    "CompareConstantRule2",
                    "CompareConstantRule3",
                    "JaeRule1",
                    "JbRule1",
                    "JnzRule1",
                    "JnzRule2",
                    "JnzRule3",
                    "JnzRule4",
                    "JnzRule5",
                    "JnzRule6",
                    "JnzRule7",
                    "JnzRule8",
                    "JmpRuleZ3Const"
                ],
                "dump_intermediate_microcode": false
            }
        }
    ]
}
